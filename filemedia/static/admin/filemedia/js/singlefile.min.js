function getCsrftoken(e){var i=null;if(document.cookie&&""!=document.cookie)for(var t=document.cookie.split(";"),a=0;a<t.length;a++){var n=jQuery.trim(t[a]);if(n.substring(0,e.length+1)==e+"="){i=decodeURIComponent(n.substring(e.length+1));break}}return i}Dropzone.autoDiscover=!1,$(document).on("nifty.ready",function(){$(".dropzone").on("click",function(){var e=JSON.parse($(this).attr("data-filemedia-options")),i=$(this).attr("data-name"),t=$(this).attr("data-objectid");$("#img-"+i).dropzone({url:e.upload_url,addRemoveLinks:!1,dictDefaultMessage:"",previewsContainer:"#dropzone-preview-"+i,maxFilesize:1024,thumbnailWidth:150,uploadMultiple:!1,parallelUploads:1,thumbnailHeight:150,maxFiles:1,previewTemplate:'<div class="dz-preview"><img src="/static/admin/filemedia/img/no-thumb/td_100x100.png" class="img-responsive img-rounded dz-clickable" style="width: 160px"/><div class="dz-progress" style="width: 110px;margin-left: 25px; margin-top: -80px; position: absolute;"><div class="progress progress-striped active"><div data-dz-uploadprogress class="progress-bar progress-bar-success"></div></div></div></div>',success:function(e,t){t.status?($(e.previewTemplate).find(".dz-progress").remove(),$(e.previewTemplate).find("img").attr("id","img-"),$(e.previewTemplate).find("img").attr("rel",t.imagedefault),$(e.previewTemplate).find("img").attr("title",t.filename),$(e.previewTemplate).find("img").attr("data-id",t.id),$(e.previewTemplate).find("img").attr("data-uniquename",t.uniquename),$(e.previewTemplate).find("img").attr("data-path",t.path_date),$(e.previewTemplate).find("img").attr("data-des",t.description),$("#dropzone-get-"+i+" img").fadeIn(),$("#id_img_"+i).val(t.uniquename)):($(e.previewTemplate).remove(),$.niftyNoty({type:"danger",icon:"pli-exclamation icon-2x",message:gettext(t.data),container:"floating",timer:5e3}))},error:function(e,i){$.niftyNoty({type:"danger",icon:"pli-exclamation icon-2x",message:gettext(i),container:"floating",timer:5e3})},sending:function(e,a,n){n.append("csrfmiddlewaretoken",getCsrftoken("csrftoken")),n.append("object_id",t),$("#dropzone-get-"+i+" img").hide()},init:function(){this.on("complete",function(e){this.removeAllFiles(!0)})}})})});